%% ----------------------------------------------------------------
%% Thesis.tex -- MAIN FILE (the one that you compile with LaTeX)
%% ---------------------------------------------------------------- 

% Set up the document
\documentclass[a4paper, 11pt, oneside]{Thesis}  % Use the "Thesis" style, based on the ECS Thesis style by Steve Gunn
\graphicspath{Figures/}  % Location of the graphics files (set up for graphics to be in PDF format)

% Include any extra LaTeX packages required
\usepackage[square, numbers, comma, sort&compress]{natbib}  % Use the "Natbib" style for the references in the Bibliography
\usepackage{verbatim}  % Needed for the "comment" environment to make LaTeX comments
\usepackage{vector}  % Allows "\bvec{}" and "\buvec{}" for "blackboard" style bold vectors in maths
\hypersetup{urlcolor=blue, colorlinks=true}  % Colours hyperlinks in blue, but this can be distracting if there are many links.

%% ----------------------------------------------------------------
\begin{document}
\frontmatter      % Begin Roman style (i, ii, iii, iv...) page numbering

% Set up the Title Page
\title  {Structural multi-model coupling with CalculiX and preCICE}
\authors  {\texorpdfstring
            {\href{}{Alexandre Trujillo Boqu\'e}}
            {}
            }
\addresses  {\groupname\\\deptname\\\univname}  % Do not change this here, instead these must be set in the "Thesis.cls" file, please look through it instead
\date       {Summer 2018}
\subject    {}
\keywords   {}

\maketitle
%% ----------------------------------------------------------------

\setstretch{1.3}  % It is better to have smaller font and larger line spacing than the other way round

% Define the page headers using the FancyHdr package and set up for one-sided printing
\fancyhead{}  % Clears all page headers and footers
\rhead{\thepage}  % Sets the right side header to show the page number
\lhead{}  % Clears the left side page header

\pagestyle{fancy}  % Finally, use the "fancy" page style to implement the FancyHdr headers

%% ----------------------------------------------------------------

% The Abstract Page
\addtotoc{Abstract}  % Add the "Abstract" page entry to the Contents
\abstract{
\addtocontents{toc}{\vspace{1em}}  % Add a gap in the Contents, for aesthetics

\ldots

}

\clearpage  % Abstract ended, start a new page

%% ----------------------------------------------------------------
\lhead{\emph{Contents}}  % Set the left side page header to "Contents"
\tableofcontents  % Write out the Table of Contents

%% ----------------------------------------------------------------
%\lhead{\emph{List of Figures}}  % Set the left side page header to "List if Figures"
%\listoffigures  % Write out the List of Figures

%% ----------------------------------------------------------------
%\lhead{\emph{List of Tables}}  % Set the left side page header to "List of Tables"
%\listoftables  % Write out the List of Tables

%% ----------------------------------------------------------------
%\setstretch{1.5}  % Set the line spacing to 1.5, this makes the following tables easier to read
%\clearpage  % Start a new page
%\lhead{\emph{Abbreviations}}  % Set the left side page header to "Abbreviations"
%\listofsymbols{ll}  % Include a list of Abbreviations (a table of two columns)
%{
% \textbf{Acronym} & \textbf{W}hat (it) \textbf{S}tands \textbf{F}or \\
%\textbf{LAH} & \textbf{L}ist \textbf{A}bbreviations \textbf{H}ere \\

%}

%% ----------------------------------------------------------------
%\clearpage  % Start a new page
%\lhead{\emph{Physical Constants}}  % Set the left side page header to "Physical Constants"
%\listofconstants{lrcl}  % Include a list of Physical Constants (a four column table)
%{
% Constant Name & Symbol & = & Constant Value (with units) \\
%Speed of Light & $c$ & $=$ & $2.997\ 924\ 58\times10^{8}\ \mbox{ms}^{-\mbox{s}}$ (exact)\\

%}

%% ----------------------------------------------------------------
%\clearpage  %Start a new page
%% ----------------------------------------------------------------
% End of the pre-able, contents and lists of things
% Begin the Dedication page

%\setstretch{1.3}  % Return the line spacing back to 1.3

%\pagestyle{empty}  % Page style needs to be empty for this page
%\dedicatory{For/Dedicated to/To my\ldots}

\addtocontents{toc}{\vspace{2em}}  % Add a gap in the Contents, for aesthetics


%% ----------------------------------------------------------------
\mainmatter	  % Begin normal, numeric (1,2,3...) page numbering
\pagestyle{fancy}  % Return the page headers back to the "fancy" style

% Include the chapters of the thesis, as separate files
% Just uncomment the lines as you write the chapters

\chapter{Introduction}

    \begin{itemize}
        \item Complex phenomena can be modelled with multiphysics. It is a connected and simultaneous simulation of the sub-systems of the complex model. [ref. Keyes 2012]
        \item We can classify the approaches to multiphysics in two categories depending on the formulation of interactions. These categories are monolithic and partitioned. We take the latter.
        \item The growth of computational power, specially with parallelization, makes multiphysics possible and powerful. We have a synergy between distributed computing and a partitioned approach to modelling.
        \item Our contribution to multiphysics is a kind of "pseudo"-multiphysics, due to the fact that in our application all components share the same physical principles (structural mechanics).
        \item We use the term multimodel for this modelling of the same physics in several subsystems. That is because the model is numerically different for each subsystem. This is, the integration scheme and linearity of the numerical methods will generally not be the same.
        \item A partitioned structure-structure interaction scheme has not been explored or attempted extensively. For fluid-structure interaction there is a larger variety of studies, including many with a partitioned approach. 
        \item We see that we aim, not to integrate different physics, but to search for efficiency via the modularity of the method applied to the same physical system and the subsequent coupling of the solving modules.
        
    % Introduce multi-physics
    %The field of multi-physics simulations has achieved high popularity amongst scientists and engineers over the last decades [refs multiphysics]. An exponential gain in computational power has introduced the possibility to simulate sub-systems and their interactions simultaneously [refs of relation comput. power-multiphysics], so that they constitute models of complex phenomena, closer to real-life scenarios than single-physics models.
    %Therefore we have first of all the governing equations for each component of a simulation, and the interactions between them.

    % Multi-physics motivated by parallel computing
    %One of the main sources of computational power and possibilities of scaling is parallel computing. Another reason for the growing interest in multi-physics has been this shift towards parallel computing [refs Benjamin thesis, parallel partitioned, parallel multiphysics etc.]. This is in part related to what has already been mentioned, the increase in computational power, but also to the architecture of a multi-physics setup, where problems in sub-systems can be solved in parallel. In this thesis, parallelism is relevant since we develop a partitioned approach to multi-physics.

    % Monolithic/partitioned concept introduction 
    %Depending on how we model interactions, we will construct partitioned, monolithic or mixed approaches to multi-physics. %extend...

    %Our multi-physics is not really "multi": there is only one physics, structural mechanics (multi can come from linear-nonlinear)
    %It must be noted that our particular case is a kind of \textit{pseudo}multi-physics, since we only deal with structural physics. Nevertheless, modelling interactions between same-physics sub-systems still represents a challenge, and compared to other multi-physics problems [refs FSI, etc., general multiphysics], there is not much work in structure-structure interaction. Also coupling linear structural mechanics with non-linear structural mechanics can be considered as multi-physics since we make different assumptions for the numeric modelling.
    %(coupling systems with the same underlying physics can be beneficial in terms of efficiency.)

        \item Multiphysics/multimodelling translates here into using the same single-physics solver for each system and then (strongly) coupling them with a tool (preCICE)
    \end{itemize}
    
    This report is structured in the following way. After presenting the background and motivations, in section 2 \ldots
    
    \section{Background}

        \begin{itemize}
            \item A short overview of developments in computational structural mechanics 1. in general, 2. in the monolithic path, 3. in the partitioned path (not much here, put all refs. found). Saying what every method has brought: domain decomposition, multi-scaling, explicit/implicit, etc. References here: Gravouil 2001 and 2003, Cagatay 2016, Prakash 2004 and 2013, Gendre 2009 and 2011, Causin 2005, Faucher 2002, Herry 2002, Ghanem 2012,%refs here may be mentioned more than once if they brought new stuff in general and also for the monolithic/partitioned paradigm per se
            \item A short overview of developments in partitioned FSI. Refs. here: Matthies 2002.
            \item For a survey of multi-physics frameworks developed until 2015, see [Babur 2015].
        \end{itemize}

    \section{Motivation. Goals.}
    
        \begin{itemize}
            \item Speedup from scaling of parallelization running Calculix in a massively parallel setup [refs Benjamin's thesis?].
            \item Fast-paced development, use of existing single-physics black-box solvers.
            \item Speedup from linear-nonlinear coupling. Simulate part of interest (with complex, hard-to-capture behaviour/effects) with nonlinear model, and the rest with linear.
            \item Monolithic methods impose conditions on the interface that ensure convergence. We hope that our partitioned scheme brings this property, to achieve this we try to replicate these conditions with implicit coupling.
        \end{itemize}


\chapter{Theory}

    \section{Basic notions of computational structural mechanics}
    
        \begin{itemize}
            \item Presentation of the equations of motion that govern the domain we simulate.  Our (only) physics.
            \item Discretization of the equations through a FEM. Presentation in the matrix form. This form is valid in each subsystem and the system as a whole. Mass matrix, internal and external forces.
            \item Newmark method, time integration.
            \item ~[ref. Gravouil, ]
        \end{itemize}
    
    \section{Coupling structural simulations. Partitioned and monolithic approaches}
    
        \begin{itemize}
            \item Dual Schur decomposition. 
            \item Finer or coarser refining of mesh in subdomains.
            \item Many (monolithic) methods implement subcycling. This means that for each division of the spatial domain, the time discretization is performed with different step lengths. We will mention this but not go into detail as we restrict to having only one time-step length. (\ldots to having the same time-step length for all spatial subdomains)
            \item Methods implementing coupling in linear conditions, nonlinear, and linear-nonlinear. 
            \item Explicit and implicit time integration. Note that in a monolithic setup this has nothing to do with a fixed-point iteration. This is relevant because later we will mainly use the terms explicit and implicit when referring to the partitioned coupling setup. The latter incorporates the local integration methods with a black-box philosophy that makes the consideration of implicit/explicit time integration not so relevant in practice. (in the same line, we don't go into the FEM implementation of calculix (see ref HHT method))
        \end{itemize}    
    
        \subsection{Monolithic structural simulation}
        
            \begin{itemize}
                \item Start from the equations of motion in matrix form from previous section.
                \item Formulation for each subsystem and definition of terms of connection.
                \item Main/general methodologies used in literature.
                \item ~[ref. Gravouil 2001 and 2003, Prakash 2004 and 2013, etc.]
            \end{itemize}
            
        \subsection{Partitioned structural simulations}
        
            \begin{itemize}
                \item Review with terminology in [Felippa 2001]. Consider that this review is about simulations with at least one structural component, not only structure-structure coupling.
                \item ~[ref. Gendre 2009 and 2011, etc.]
            \end{itemize}
            
            \subsubsection{From partitioned FSI}
                \begin{itemize}
                    \item In FSI we have a setup that has one structural participant in the simulation.
                    \item Added mass effect. Will it affect a purely structural simulation? [Causin 2005, Idelsohn 2009]
                    \item FSI in preCICE [preCICE refs.]
                    \item Matthies 2002 has implicit coupling in a partitioned FSI simulation.
                \end{itemize}
            
\chapter{Software in the project}

    \section{preCICE - A coupling library for partitioned multi-physics simulation}
        
        \subsection{Purpose}
        
        \begin{itemize}
            \item Why use preCICE.
        \end{itemize}
        
        \subsection{Overview of functioning}
        
        \begin{itemize}
            \item Very basic explaining of the coupling schemes, communication, data mapping, config files, etc.
        \end{itemize}
        
            \subsubsection{Quasi-Newton schemes}
                \begin{itemize}
                    \item What are they and why do we (need to) apply them.
                    \item How do they work (get a bit technical) and how are they implemented (user level). [refs. Benjamin's thesis, preCICE paper]
                \end{itemize}
    
    
    \section{CalculiX - A three-dimensional structural finite element program}
    
        \begin{itemize}
            \item CalculiX is a program that integrates solving routines for several types of structural finite element analysis. [ref. calculix page, manual]
            \item We run (geometrically) linear and nonlinear dynamic analysis.
        \end{itemize}
    
        \subsection{Meshing and configuration of a run}
    
        \subsection{Numerics}
        
            \begin{itemize}
                \item HHT method implemented in calculix, which derived from $\alpha$-method, which in turn derived from Newmark method
                \item CalculiX is black-box in our method (\ldots is black-box for preCICE), therefore the contents of this section are merely informative but not needed for implementation, etc.
            \end{itemize}
        
        
\chapter{Methodology}

    \section{Overview}

    \section{Implementation}
    
        Describe implementation of the structure-structure component in the preCICE adapter for CalculiX.
    
    \section{Tests}
    
        \subsection{Beam test case}
            
            \subsubsection{CalculiX input file/deck}
                \begin{itemize}
                    \item Linear / Nonlinear
                \end{itemize}
            \subsubsection{Geometry}
                \begin{itemize}
                    \item Meshes.
                \end{itemize}
        
        \subsection{Comparison partitioned vs. monolithic}

            \begin{itemize}
                \item Quantification of error using L2 norm for displacements and forces. Implementation.
            \end{itemize}
            
        \subsection{Convergence studies/experiments}
            \begin{itemize}
                \item Range of validity of parameters: where the simulation converges.
                \item Optimal parameters: where the simulation is faster. Less coupling iterations.
                \item Tests to find valid and optimal parameters.
            \end{itemize}
            \subsubsection{Parameters}
                \begin{itemize}
                    \item Limit for the filtering in Quasi-Newton schemes (IQN-ILS). Filter type 1 and 2.
                    \item Convergence measure limit.
                    \item Material properties of structure: density, Young modulus, Poisson coefficient.
                    \item Time step.
                    \item Load.
                \end{itemize}

\chapter{Results and discussion}

    \section{Convergence studies}
   
        \begin{itemize}
            \item Study of error against convergence limit. Error proportional to convergence limit up to an offset. Test for several time steps. Error offset decreases with time step (in a reasonable range for time steps) in a very continuous and smooth way. Deduce offset is due to a time splitting error introduced by the coupling.
            \item Evolution of iterations necessary to converge in each time step. Effect of step loading/constant loading.
        \end{itemize}


\chapter{Conclusions}

\chapter*{Acknowledgements}
%% ----------------------------------------------------------------
% Now begin the Appendices, including them as separate files

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

\appendix % Cue to tell LaTeX that the following 'chapters' are Appendices

%\input{Appendices/AppendixA}	% Appendix Title


\addtocontents{toc}{\vspace{2em}}  % Add a gap in the Contents, for aesthetics
\backmatter

%% ----------------------------------------------------------------
\label{Bibliography}
\lhead{\emph{Bibliography}}  % Change the left side page header to "Bibliography"
\bibliographystyle{unsrtnat}  % Use the "unsrtnat" BibTeX style for formatting the Bibliography
\bibliography{Bibliography}  % The references (bibliography) information are stored in the file named "Bibliography.bib"

\end{document}  % The End
%% ----------------------------------------------------------------